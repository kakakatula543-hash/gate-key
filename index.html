<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gate Key</title>
<style>
body{
  background:#0b0b0b;
  color:#00ffcc;
  font-family:Arial, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.box{
  border:2px solid #00ffcc;
  padding:25px;
  border-radius:10px;
  text-align:center;
  box-shadow:0 0 15px #00ffcc;
}
button{
  padding:10px 20px;
  background:#00ffcc;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-size:16px;
}
</style>
</head>
<body>

<div class="box" id="box">ƒêang t·∫£i...</div>

<script>
/* ===== FIX 404 THI·∫æU D·∫§U / ===== */
if (
  location.pathname === "/gate-key" ||
  location.pathname === "/gate-key/index.html"
) {
  location.replace("/gate-key/" + location.search);
}

/* ===== LOGIC GATE KEY ===== */
const box = document.getElementById("box");
const params = new URLSearchParams(location.search);
const done = params.get("done");

function genKey(){
  return "kpd_" + Math.random().toString(36).substring(2,8).toUpperCase();
}

const savedKey = localStorage.getItem("user_key");
const token = localStorage.getItem("passed_link");

/* ƒê√É C√ì KEY ‚Üí HI·ªÜN LU√îN */
if(savedKey){
  box.innerHTML = `
    <h3>üîë Key c·ªßa b·∫°n</h3>
    <b>${savedKey}</b>
    <p>(1 ng∆∞·ªùi = 1 key)</p>
  `;
}

/* V·ª™A V∆Ø·ª¢T LINK XONG */
else if(done === "1" && token){
  const newKey = genKey();
  localStorage.setItem("user_key", newKey);
  box.innerHTML = `
    <h3>‚úÖ Nh·∫≠n key th√†nh c√¥ng</h3>
    <b>${newKey}</b>
  `;
}

/* CH∆ØA V∆Ø·ª¢T LINK */
else{
  box.innerHTML = `
    <h3>üîí V∆∞·ª£t link ƒë·ªÉ nh·∫≠n key</h3>
    <button onclick="goLink()">V∆∞·ª£t link</button>
  `;
}

function goLink(){
  localStorage.setItem("passed_link","ok");
  window.location.href = "https://yeulink.com/kephandienkey";
}
</script>

</body>
</html>
